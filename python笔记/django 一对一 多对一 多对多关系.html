<html>
<head>
  <title>django 一对一 多对一 多对多关系</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/306387 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="820"/>
<h1>django 一对一 多对一 多对多关系</h1>

<div>
<span><div><div align="left" style="min-height: 21pt;"><font color="#010101" face="黑体" size="4"><span style="font-size:16pt"><b>一、Django数据库查询操作</b></span></font></div><div align="justify" style="min-height: 15pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">在Django中，与数据库的大多数交互都通过对象关系映射器（ORM）。</span></font></div><div align="justify" style="min-height: 15pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">参考资料：</span></font><a href="https://docs.djangoproject.com/en/1.11/topics/db/queries/#topics-db-queries"><font color="#800080" face="Calibri" size="2"><span style="font-size:10pt"><u>https://docs.djangoproject.com/en/1.11/topics/db/queries/#topics-db-queries</u></span></font></a></div><ol start="2" style="margin-bottom: 0mm; margin-left: 0mm; padding-left: 0pt;"><li style="margin-left: 15pt; margin-right: 0pt; padding-left: -18pt; text-indent:0pt; font-family: ����; font-size: 16pt; font-weight: Bold; color: #010101;"><div style="margin-top: 0pt; margin-bottom: 13pt;"><h2 align="justify"><font color="#010101" face="黑体" size="4"><span style="font-size:16pt; font-family:����; color:#010101; font-weight:Bold; font-style:Normal; font-decoration:Normal"><b>models中的relationships</b></span></font></h2></div></li></ol><div align="justify" style="min-height: 15pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">参考资料：</span></font><a href="https://docs.djangoproject.com/en/1.11/topics/db/examples/"><font color="#800080" face="Calibri" size="2"><span style="font-size:10pt"><u>https://docs.djangoproject.com/en/1.11/topics/db/examples/</u></span></font></a></div><div align="justify" style="min-height: 15pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">注：可以使用python manage.py sqlmigrate app_name migration_name查看migration对应的SQL语句。</span></font></div><ol style="margin-bottom: 0mm; margin-left: 0mm; padding-left: 0pt;"><li style="margin-left: 15pt; margin-right: 0pt; padding-left: -18pt; text-indent:0pt; font-family: ����; font-size: 16pt; font-weight: Bold; color: #010101;"><div style="margin-top: 0pt; margin-bottom: 13pt;"><h3 align="justify"><font color="#010101" face="宋体" size="4"><span style="font-size:16pt; font-family:����; color:#010101; font-weight:Bold; font-style:Normal; font-decoration:Normal"><b>Many-to-many relationships</b></span></font></h3></div></li></ol><h3 align="justify"></h3><p align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.57mm; margin-bottom:4.57mm;"><img src="django 一对一 多对一 多对多关系_files/Image.png" type="image/png" data-filename="Image.png" alt="2017-05-03_162949" border="0" height="273" width="553"/></p><p style="page-break-before:always"><font color="#010101" face="宋体" size="4"><span style="font-size:16pt"><b><br/></b></span></font></p><ol style="margin-top: 0mm; margin-bottom: 0mm; margin-left: 0mm; padding-left: 0pt;"><li style="margin-left: 15pt; margin-right: 0pt; padding-left: -18pt; text-indent:0pt; font-family: ����; font-size: 10pt; color: #010101;"><div align="justify" style="min-height: 15pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt; font-family:����; color:#010101; font-weight:Normal; font-style:Normal; font-decoration:Normal">在models.py中添加多对多的映射关系；</span></font></div></li><li style="margin-left: 15pt; margin-right: 0pt; padding-left: -18pt; text-indent:0pt; font-family: ����; font-size: 10pt; color: #010101;"><div align="justify" style="min-height: 15pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt; font-family:����; color:#010101; font-weight:Normal; font-style:Normal; font-decoration:Normal">执行 python manage.py makemigrations，生成0001_initial.py</span></font></div></li><li style="margin-left: 15pt; margin-right: 0pt; padding-left: -18pt; text-indent:0pt; font-family: ����; font-size: 10pt; color: #010101;"><div align="justify" style="min-height: 15pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt; font-family:����; color:#010101; font-weight:Normal; font-style:Normal; font-decoration:Normal">执行python manage.py sqlmigrate article 0001_initial&gt;article.sql，生成SQL语句；</span></font></div></li><li style="margin-left: 15pt; margin-right: 0pt; padding-left: -18pt; text-indent:0pt; font-family: ����; font-size: 10pt; color: #010101;"><div align="justify" style="min-height: 15pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt; font-family:����; color:#010101; font-weight:Normal; font-style:Normal; font-decoration:Normal">分析SQL语句与models对</span></font><font color="#010101" face="Calibri" size="2"><span style="font-size:10pt">“</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">多对多关系的处理</span></font><font color="#010101" face="Calibri" size="2"><span style="font-size:10pt">”</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">；</span></font></div></li><li style="margin-left: 15pt; margin-right: 0pt; padding-left: -18pt; text-indent:0pt; font-family: ����; font-size: 10pt; color: #010101;"><div align="justify" style="min-height: 15pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt; font-family:����; color:#010101; font-weight:Normal; font-style:Normal; font-decoration:Normal">执行 python manage.py shell进入django  shell，通过django操作数据库；</span></font></div></li></ol><div align="justify" style="min-height: 15pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">&gt;&gt;&gt; from article.models import Article,Publication</span></font></div><div align="justify" style="min-height: 15pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">&gt;&gt;&gt; p1 = Publication(title='The Python Journal')</span></font></div><div align="justify" style="min-height: 15pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">&gt;&gt;&gt; p1.save()</span></font></div><div align="justify" style="min-height: 15pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">&gt;&gt;&gt; p2 = Publication(title='Science News')</span></font></div><div align="justify" style="min-height: 15pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">&gt;&gt;&gt; p2.save()</span></font></div><div align="justify" style="min-height: 15pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">&gt;&gt;&gt; p3 = Publication(title='Science Weekly')</span></font></div><div align="justify" style="min-height: 15pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">&gt;&gt;&gt; p3.save()</span></font></div><div align="justify" style="min-height: 15pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">&gt;&gt;&gt; a1 = Article(headline='Django lets you build Web apps easily')</span></font></div><div align="justify" style="min-height: 15pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">&gt;&gt;&gt; a1.save()</span></font></div><div align="justify" style="min-height: 15pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">&gt;&gt;&gt; a1.publications.add(p1)</span></font></div><div align="justify" style="min-height: 15pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">&gt;&gt;&gt; a2 = Article(headline='NASA uses Python')</span></font></div><div align="justify" style="min-height: 15pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">&gt;&gt;&gt; a2.save()</span></font></div><div align="justify" style="min-height: 15pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">&gt;&gt;&gt; a2.publications.add(p1, p2)</span></font></div><div align="justify" style="min-height: 15pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">&gt;&gt;&gt; a2.publications.add(p3)</span></font></div><div align="justify" style="min-height: 15pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">&gt;&gt;&gt; a1.publications.all()  # 查看与a1相关联的所有Publication</span></font></div><div align="justify" style="min-height: 15pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">&gt;&gt;&gt; p2.article_set.all()  #查看与p2相关联的所有Article</span></font></div><div align="justify" style="min-height: 15pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">操作数据库的过程中查看数据库的变化。</span></font></div><ol start="2" style="margin-bottom: 0mm; margin-left: 0mm; padding-left: 0pt;"><li style="margin-left: 15pt; margin-right: 0pt; padding-left: -18pt; text-indent:0pt; font-family: ����; font-size: 16pt; font-weight: Bold; color: #010101;"><div style="margin-top: 0pt; margin-bottom: 13pt;"><h3 align="justify"><font color="#010101" face="宋体" size="4"><span style="font-size:16pt; font-family:����; color:#010101; font-weight:Bold; font-style:Normal; font-decoration:Normal"><b>Many-to-one</b></span></font></h3></div></li></ol><div align="justify" style="min-height: 201pt;"><img src="django 一对一 多对一 多对多关系_files/Image [1].png" type="image/png" data-filename="Image.png" alt="2017-05-03_162644" border="0" height="268" width="554"/></div><ol start="3" style="margin-bottom: 0mm; margin-left: 0mm; padding-left: 0pt;"><li style="margin-left: 15pt; margin-right: 0pt; padding-left: -18pt; text-indent:0pt; font-family: ����; font-size: 16pt; font-weight: Bold; color: #010101;"><div style="margin-top: 0pt; margin-bottom: 13pt;"><h3 align="justify"><font color="#010101" face="宋体" size="4"><span style="font-size:16pt; font-family:����; color:#010101; font-weight:Bold; font-style:Normal; font-decoration:Normal"><b>One-to-one</b></span></font></h3></div></li></ol><div align="justify" style="min-height: 184pt;"><img src="django 一对一 多对一 多对多关系_files/Image [2].png" type="image/png" data-filename="Image.png" alt="2017-05-03_161317" border="0" height="246" width="556"/></div></div></span>
</div></body></html> 